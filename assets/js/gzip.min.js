var ID1=31,ID2=139,compressionMethods={deflate:8},possibleFlags={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},osMap={fat:0,amiga:1,vmz:2,unix:3,"vm/cms":4,atari:5,hpfs:6,macintosh:7,"z-system":8,cplm:9,"tops-20":10,ntfs:11,qdos:12,acorn:13,vfat:14,vms:15,beos:16,tandem:17,theos:18},os='unix',DEFAULT_LEVEL=6;function putByte(a,b){b.push(255&a)}function putShort(a,b){b.push(255&a),b.push(a>>>8)}function putLong(a,b){putShort(65535&a,b),putShort(a>>>16,b)}function putString(a,b){var c,d=a.length;for(c=0;c<d;c+=1)putByte(a.charCodeAt(c),b)}function readByte(a){return a.shift()}function readShort(a){return a.shift()|a.shift()<<8}function readLong(a){var b=readShort(a),c=readShort(a);return 32768<c?(c-=32768,(c<<16|b)+2147483648):c<<16|b}function readString(a){for(var b=[];0!==a[0];)b.push(String.fromCharCode(a.shift()));return a.shift(),b.join('')}function readBytes(a,b){var c,d=[];for(c=0;c<b;c+=1)d.push(a.shift());return d}function zip(a,b){var c,d=0,e=[];return b||(b={}),c=b.level||DEFAULT_LEVEL,'string'==typeof a&&(a=Array.prototype.map.call(a,function(a){return a.charCodeAt(0)})),putByte(ID1,e),putByte(ID2,e),putByte(compressionMethods.deflate,e),b.name&&(d|=possibleFlags.FNAME),putByte(d,e),putLong(b.timestamp||parseInt(Date.now()/1e3,10),e),1===c?putByte(4,e):9===c?putByte(2,e):putByte(0,e),putByte(osMap[os],e),b.name&&(putString(b.name.substring(b.name.lastIndexOf('/')+1),e),putByte(0,e)),deflate(a,c).forEach(function(a){putByte(a,e)}),putLong(CRC32.buf(a),e),putLong(a.length,e),e}function unzip(a){var b,c,d,e,f,g,h,i,j,k=Array.prototype.slice.call(a,0);if(readByte(k)!==ID1||readByte(k)!==ID2)throw'Not a GZIP file';if(b=readByte(k),b=Object.keys(compressionMethods).some(function(a){return c=a,compressionMethods[a]===b}),!b)throw'Unsupported compression method';if(d=readByte(k),e=readLong(k),f=readByte(k),b=readByte(k),Object.keys(osMap).some(function(a){if(osMap[a]===b)return g=a,!0}),d&possibleFlags.FEXTRA&&(b=readShort(k),readBytes(k,b)),d&possibleFlags.FNAME&&readString(k),d&possibleFlags.FCOMMENT&&readString(k),d&possibleFlags.FHCRC&&readShort(k),'deflate'===c&&(j=deflate.inflate(k.splice(0,k.length-8))),d&possibleFlags.FTEXT&&(j=Array.prototype.map.call(j,function(a){return String.fromCharCode(a)}).join('')),h=readLong(k)>>>0,h!==parseInt(crc32(j),16))throw'Checksum does not match';if(i=readLong(k),i!==j.length)throw'Size of decompressed file not correct';return j}